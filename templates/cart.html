{% extends 'base.html' %}
{% block content %}
<h2>Your Cart</h2>
{% if items %}
<div id="checkout-warning" class="alert alert-danger d-none"></div>
<div class="table-responsive">
<table class="table table-striped align-middle">
  <thead>
    <tr><th></th><th></th><th>Item</th><th style="width:160px;">Quantity</th><th>Price</th><th>Subtotal</th><th>Action</th></tr>
  </thead>
  <tbody>
  {% for it in items %}
    <tr class="cart-item-row" data-pid="{{ it.product_id }}">
      <td><input type="checkbox" class="select-item" value="{{ it.product_id }}"></td>
      <td>
        {% if it.image_url %}
          <img src="{{ it.image_url }}" class="cart-thumb me-2" alt="{{ it.name }}">
        {% else %}
          <div class="cart-thumb bg-light d-inline-block me-2"></div>
        {% endif %}
      </td>
      <td><a href="{% url 'product_detail' it.product_id %}">{{ it.name }}</a></td>
      <td>
        <div class="input-group">
          <button class="btn btn-outline-secondary qty-decrease">-</button>
          <input type="number" class="form-control qty-input text-center" value="{{ it.qty }}" min="1">
          <button class="btn btn-outline-secondary qty-increase">+</button>
        </div>
      </td>
      <td>${{ it.price }}</td>
      <td>$<span data-subtotal="{{ it.product_id }}">{{ it.subtotal }}</span></td>
      <td><button class="btn btn-sm btn-danger remove-item" data-pid="{{ it.product_id }}">Remove</button></td>
    </tr>
  {% endfor %}
  </tbody>
</table>
</div>
<div class="d-flex justify-content-between align-items-center">
  <div>
    <h6>Selected Total: $<span id="cart-selected-total">0.00</span></h6>
    <small class="text-muted">Cart Total (all items): $<span id="cart-total-all">{{ total }}</span></small>
  </div>
  <div>
    <button id="checkout-btn" class="btn btn-success" disabled>Proceed to Checkout</button>
  </div>
</div>
{% else %}
<div class="alert alert-info">Your cart is empty.</div>
{% endif %}
{% endblock %}